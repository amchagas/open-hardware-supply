---
title: "combine_repeated_entries"
author: "Andre M Chagas"
date: "16/07/2020"
output: html_document
---
## RMarkdown to filter and combine repetitive entries of the 'allData.csv' file

```{r attach-libraries}

## clear workspace
rm(list = ls())

library(tidyverse)#
library(here)
```
```



```{r load-csv}

allData <- read.csv(here("data","allData.csv"))


names(allData)

##"title" contain the entries we need
```

```{r sort-title}

## set all titles to lower case
lowTitles<-tolower(allData$title)

##order titles
ordered<-order(lowTitles)

##show first 10 entries
head(lowTitles[ordered],10)

## save to file to cross-check
write.csv(lowTitles[ordered],here("data","lowTitles_first.csv"))

```


### from this first check, we can see that the titles need some cleaning:

- some entries are with a single quote, some with double, and some with tilted quote
- some have \"
- some entries have a newline escape in the middle.
- etc

So let's clean it by:

- making all ' and ` and `` and \" into a single '
- removing the newline escape


```{r clean-naming}

## remove \n
lowTitles <- gsub("\n","",lowTitles)

## remove \"
lowTitles <- gsub("\"","",lowTitles)

## substitute " `" for '
lowTitles <- gsub(" `","'",lowTitles)

## substitute "` " for '
lowTitles <- gsub("` ","'",lowTitles)

## substitute "`" for '
lowTitles <- gsub("`","'",lowTitles)

## substitute "''" for '
lowTitles <- gsub("''","'",lowTitles)

## substitute """ for '
lowTitles <- gsub("\"","'",lowTitles)


## reorder things 
ordered<-order(lowTitles)


head(lowTitles[ordered],10)

## save lowTitles for a quick human check
write.csv(lowTitles[ordered],here("data","lowTitles.csv"))

```


```{r check-duplicates}


#number of repeated entries
length(all_data$title)-length(unique(all_data$title))

#get all duplicated titles
rep_titles<-all_data[duplicated(all_data$title) ,"title"]


```


```{r combine-duplicates}




length(all_data[rep_titles[1],])




```


